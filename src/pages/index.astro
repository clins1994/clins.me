---
import BaseHead from '../components/BaseHead.astro'
import Header from '../components/Header.astro'
import Footer from '../components/Footer.astro'
import { SITE_DESCRIPTION, ABOUT, FULL_NAME } from '../consts'
import { EXPERIENCE } from '../data/experience'

const projects = [
  {
    title: 'clins.me',
    href: 'https://github.com/clins1994/clins.me',
    description:
      'My personal website and portfolio, including a markdown-powered resume page and curated project highlights.',
    cta: 'View on GitHub',
    tags: ['Astro', 'Tailwind CSS', 'TypeScript', 'Markdown']
  },
  {
    title: 'Raycast Extensions',
    href: 'https://www.raycast.com/clins1994',
    description:
      'A growing set of Raycast extensions focused on workflow speed, automation, and delightful UX.',
    cta: 'Explore on Raycast',
    tags: ['TypeScript', 'React', 'Automation', 'Productivity']
  },
  {
    title: 'Computer Vision & Image Processing',
    href: 'https://github.com/clins1994/comp-vision-img-proc',
    description:
      'Processed microscopic imagery to improve nanoparticle counting in research labs for CCM304M133 during my M.Sc. at UFABC.',
    cta: 'View on GitHub',
    tags: ['Python', 'Jupyter Notebook', 'Computer Vision', 'Research']
  },
  {
    title: 'AnimAR',
    href: 'https://www.researchgate.net/publication/286838474_Animar_Augmenting_the_Reality_of_Storyboards_and_Animations',
    description:
      'AR research on augmenting storyboards and animations for better prototyping; won Best Application (Got HeARt), Metaio Developer Contest 2013.',
    cta: 'Read publication',
    tags: ['Augmented Reality', 'Research', 'Metaio SDK', 'Android', 'Java']
  },
  {
    title: 'Augmented Reality Board Game',
    href: 'https://github.com/alpaccioly/Pillol',
    description:
      'An AR board game themed around pillow fights where moving physical blocks repositions autonomous characters to attack and dodge.',
    cta: 'View on GitHub',
    tags: ['Augmented Reality', 'Game Development', 'Metaio SDK', 'C++']
  },
  {
    title: 'Smart Dish for Kids',
    href: 'https://www.projetao.com.br/generator/?',
    description:
      'An Arduino-powered dish connected to a smartphone game that reacts positively when a child eats, turning mealtime into play.',
    cta: 'View project',
    tags: ['Arduino', 'IoT', 'Unity', 'C#', 'Mobile Game', 'Education']
  }
]
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={FULL_NAME} description={SITE_DESCRIPTION} />
  </head>
  <body
    class="bg-[radial-gradient(circle_at_20%_20%,rgba(255,255,255,0.7),transparent_55%),radial-gradient(circle_at_80%_0%,rgba(235,94,40,0.12),transparent_55%),linear-gradient(160deg,#f6efe6,#efe4d7)] text-stone-900"
  >
    <div
      class="relative min-h-screen before:pointer-events-none before:fixed before:inset-[-20vmax] before:-z-10 before:bg-[radial-gradient(circle_at_70%_10%,rgba(235,94,40,0.22),transparent_60%)] before:opacity-60"
    >
      <div
        class="mx-auto grid w-full max-w-6xl gap-14 px-6 py-16 lg:grid-cols-[0.85fr_1.15fr] lg:items-start lg:px-8 lg:py-24"
      >
        <Header />
        <main class="flex flex-col gap-16 lg:pt-4">
          <section
            id="about"
            class="scroll-mt-8 pb-4 transition-all duration-700 ease-out motion-reduce:transition-none lg:scroll-mt-10"
            data-section
            data-reveal
          >
            <div class="mb-6">
              <p class="mb-2 text-[0.7rem] uppercase tracking-[0.4em] text-stone-500">About</p>
              <h2 class="m-0 text-[clamp(1.6rem,2.5vw,2.2rem)]">{ABOUT.intro}</h2>
            </div>
            <div class="grid gap-4 text-stone-600">
              <p>
                {ABOUT.paragraphs[0]}
                <a
                  class="font-medium text-orange-600 underline decoration-2 underline-offset-2 hover:text-orange-700"
                  href={ABOUT.cta.href}
                  target="_blank"
                  rel="noreferrer"
                >
                  {ABOUT.cta.label}
                </a>
                {ABOUT.suffix}
              </p>
              {ABOUT.paragraphs.slice(1).map((paragraph) => <p>{paragraph}</p>)}
            </div>
          </section>

          <section
            id="experience"
            class="scroll-mt-8 pb-4 transition-all duration-700 ease-out motion-reduce:transition-none lg:scroll-mt-10"
            data-section
            data-reveal
          >
            <div class="mb-6">
              <p class="mb-2 text-[0.7rem] uppercase tracking-[0.4em] text-stone-500">Experience</p>
              <h2 class="m-0 text-[clamp(1.6rem,2.5vw,2.2rem)]">Selected roles and impact</h2>
            </div>
            <ul class="m-0 grid list-none gap-6 p-0">
              {
                EXPERIENCE.map((item, index) => (
                  <li
                    class="group relative overflow-hidden rounded-[1.2rem] border border-stone-300/70 bg-stone-50 p-6 shadow-[0_14px_60px_rgba(30,27,22,0.12)] transition-all duration-700 ease-out hover:-translate-y-1 hover:border-orange-500/30 hover:shadow-[0_20px_60px_rgba(30,27,22,0.2)] motion-reduce:transition-none after:absolute after:inset-x-0 after:bottom-0 after:h-[3px] after:bg-[linear-gradient(90deg,transparent,#eb5e28,transparent)] after:opacity-0 after:transition-opacity group-hover:after:opacity-100"
                    data-reveal
                    data-delay={index * 80}
                  >
                    <div class="mb-2">
                      <p class="mb-1 font-mono text-xs uppercase tracking-[0.2em] text-stone-500">
                        {item.start} - {item.end ?? 'Present'}
                      </p>
                      <h3 class="m-0 text-[1.2rem]">
                        {item.company.href ? (
                          <a
                            class="border-b-2 border-transparent transition hover:border-orange-600 focus-visible:border-orange-600"
                            href={item.company.href}
                            target="_blank"
                            rel="noreferrer"
                          >
                            {item.role} · {item.company.name}
                          </a>
                        ) : (
                          `${item.role} · ${item.company.name}`
                        )}
                      </h3>
                      <p class="mt-1 text-sm text-stone-500">{item.location}</p>
                    </div>
                    <ul class="mt-4 grid list-none gap-2 p-0 text-stone-600">
                      {item.highlights.map((highlight) => (
                        <li class="relative pl-[1.1rem] before:absolute before:left-0 before:text-orange-600 before:content-['—']">
                          {highlight}
                        </li>
                      ))}
                    </ul>
                    <ul class="mt-4 flex flex-wrap gap-2" aria-label="Technologies">
                      {item.tags.map((tag) => (
                        <li class="rounded-full bg-orange-500/15 px-3 py-1.5 text-xs uppercase tracking-[0.08em] text-orange-600">
                          {tag}
                        </li>
                      ))}
                    </ul>
                  </li>
                ))
              }
            </ul>
          </section>

          <section
            id="projects"
            class="scroll-mt-8 pb-4 transition-all duration-700 ease-out motion-reduce:transition-none lg:scroll-mt-10"
            data-section
            data-reveal
          >
            <div class="mb-6">
              <p class="mb-2 text-[0.7rem] uppercase tracking-[0.4em] text-stone-500">Projects</p>
              <h2 class="m-0 text-[clamp(1.6rem,2.5vw,2.2rem)]">Selected work</h2>
            </div>
            <ul class="m-0 grid list-none gap-6 p-0">
              {
                projects.map((project, index) => (
                  <li
                    class="group relative overflow-hidden rounded-[1.2rem] border border-stone-300/70 bg-stone-50 p-6 shadow-[0_14px_60px_rgba(30,27,22,0.12)] transition-all duration-700 ease-out hover:-translate-y-1 hover:border-orange-500/30 hover:shadow-[0_20px_60px_rgba(30,27,22,0.2)] motion-reduce:transition-none after:absolute after:inset-x-0 after:bottom-0 after:h-[3px] after:bg-[linear-gradient(90deg,transparent,#eb5e28,transparent)] after:opacity-0 after:transition-opacity group-hover:after:opacity-100"
                    data-reveal
                    data-delay={index * 80}
                  >
                    <div class="mb-2">
                      <p class="mb-1 font-mono text-xs uppercase tracking-[0.2em] text-stone-500">
                        Featured
                      </p>
                      <h3 class="m-0 text-[1.2rem]">
                        {project.href ? (
                          <a
                            class="border-b-2 border-transparent transition hover:border-orange-600 focus-visible:border-orange-600"
                            href={project.href}
                            target="_blank"
                            rel="noreferrer"
                          >
                            {project.title}
                          </a>
                        ) : (
                          <span>{project.title}</span>
                        )}
                      </h3>
                    </div>
                    <p class="m-0 text-stone-600">{project.description}</p>
                    <ul class="mt-4 flex flex-wrap gap-2" aria-label="Project tags">
                      {project.tags.map((tag) => (
                        <li class="rounded-full bg-orange-500/15 px-3 py-1.5 text-xs uppercase tracking-[0.08em] text-orange-600">
                          {tag}
                        </li>
                      ))}
                    </ul>
                    {project.href && project.cta ? (
                      <a
                        class="mt-4 inline-flex items-center gap-1 font-semibold text-orange-600"
                        href={project.href}
                        target="_blank"
                        rel="noreferrer"
                      >
                        {project.cta}
                        <span
                          aria-hidden="true"
                          class="font-mono transition-transform group-hover:translate-x-1 motion-reduce:transition-none"
                        >
                          →
                        </span>
                      </a>
                    ) : null}
                  </li>
                ))
              }
            </ul>
          </section>

          <Footer />
        </main>
      </div>
    </div>
    <script is:inline>
      {
        ;`
        const revealItems = [...document.querySelectorAll('[data-reveal]')];
        const reduceMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

        if ('IntersectionObserver' in window && !reduceMotion) {
          revealItems.forEach((item) => item.classList.add('opacity-0', 'translate-y-4'));

          const revealObserver = new IntersectionObserver(
            (entries) => {
              entries.forEach((entry) => {
                if (entry.isIntersecting) {
                  const delay = Number(entry.target.getAttribute('data-delay') || 0);
                  if (delay > 0) entry.target.style.transitionDelay = delay + 'ms';
                  entry.target.classList.remove('opacity-0', 'translate-y-4');
                  entry.target.classList.add('opacity-100', 'translate-y-0');
                  revealObserver.unobserve(entry.target);
                }
              });
            },
            { threshold: 0.2 }
          );

          revealItems.forEach((item) => revealObserver.observe(item));
        }

        const sections = [...document.querySelectorAll('section[data-section]')];
        const navLinks = [...document.querySelectorAll('[data-nav]')];
        const setActiveNav = (id) => {
          navLinks.forEach((link) => {
            const isCurrent = link.getAttribute('href') === '#' + id;
            link.setAttribute('aria-current', isCurrent ? 'true' : 'false');
          });
        };

        if ('IntersectionObserver' in window && sections.length) {
          const navObserver = new IntersectionObserver(
            (entries) => {
              entries.forEach((entry) => {
                if (!entry.isIntersecting) return;
                const id = entry.target.getAttribute('id');
                if (id) setActiveNav(id);
              });
            },
            { rootMargin: '-45% 0px -45% 0px' }
          );

          sections.forEach((section) => navObserver.observe(section));
          const firstSectionId = sections[0]?.getAttribute('id');
          if (firstSectionId) setActiveNav(firstSectionId);
        } else if (sections.length) {
          const firstSectionId = sections[0]?.getAttribute('id');
          if (firstSectionId) setActiveNav(firstSectionId);
        }
      `
      }
    </script>
  </body>
</html>
